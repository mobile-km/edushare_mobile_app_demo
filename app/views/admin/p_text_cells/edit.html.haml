.page-model-form
  = form_for [:admin, @p_text_cell] do |f|
    .field.need
      =f.text_field :title
    
    .field
      =f.text_area :desc

    .field
      - if @p_text_cell.cover
        = image_tag @p_text_cell.cover_with_first_image
      = f.file_field :cover

    .field
      = f.text_field :rformat

    .attrs
      %a.add-new-attr{:href=>'javascript:;'} 增加属性

      - @p_text_cell.rattrs.each do |rattr|
        .item{:class => rattr.new_record? ? 'new' : ''}
          - if rattr.persisted?
            = hidden_field_tag "p_text_cell[rattrs_attributes][][_id]", rattr._id
            = check_box_tag "p_text_cell[rattrs_attributes][][_destroy]", 1
          %input{:name => "p_text_cell[rattrs_attributes][][key]", :size => "20", :type => "text", :value => rattr.key}
          %input{:name => "p_text_cell[rattrs_attributes][][value]", :size => "20", :type => "text", :value => rattr.value}

    .images
      %a.add-new-image{:href=>'javascript:;'} 增加图片

      - @p_text_cell.images.each do |image|
        .image{:class => image.new_record? ? 'new' : ''}
          - if image.persisted?
            = hidden_field_tag "p_text_cell[images_attributes][][_id]", image._id
            = check_box_tag "p_text_cell[images_attributes][][_destroy]", 1
            = image_tag image.url
          = file_field_tag "p_text_cell[images_attributes][][image]"
          = text_field_tag "p_text_cell[images_attributes][][alt]", image.alt

    .field
      =f.submit
